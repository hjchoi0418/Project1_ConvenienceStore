DROP SEQUENCE employee_seq;
CREATE SEQUENCE employee_seq START WITH 1 INCREMENT BY 1;

DROP TABLE CATEGORY CASCADE CONSTRAINTS;
DROP TABLE PRODUCT CASCADE CONSTRAINTS;    
DROP TABLE WASTE CASCADE CONSTRAINTS;
DROP TABLE ALL_PRODUCTS CASCADE CONSTRAINTS;
DROP TABLE ORDER_ CASCADE CONSTRAINTS;
DROP TABLE ORDER_DETAIL CASCADE CONSTRAINTS;
DROP TABLE EMPLOYEE CASCADE CONSTRAINTS;
DROP TABLE OFFICE_HOURS CASCADE CONSTRAINTS;
DROP TABLE CASH CASCADE CONSTRAINTS;



-- 근로자
CREATE TABLE employee
            (employee_no NUMBER ,employee_id VARCHAR(20) ,employee_name VARCHAR2(10) ,hire_date DATE ,employee_wage NUMBER ,last_date DATE);
            
ALTER TABLE employee
ADD CONSTRAINT employee_pk PRIMARY KEY (employee_no);
ALTER TABLE employee ADD UNIQUE (employee_id);
ALTER TABLE employee MODIFY(employee_id NOT NULL);
-- 근로시간
CREATE TABLE office_hours
            (employee_no NUMBER ,work_on DATE ,work_off DATE ,work_time NUMBER, doe NUMBER);
            
ALTER TABLE office_hours
ADD CONSTRAINT office_hours_fk FOREIGN KEY (employee_no) REFERENCES employee(employee_no);

-- 시재
CREATE TABLE cash
            (cash NUMBER, deposit_withdrawal CHAR(1), amount NUMBER, cash_date DATE);

ALTER TABLE cash
ADD CONSTRAINT cash_deposit_withdrawal_check CHECK(deposit_withdrawal IN('D', 'W'));

-- 제품카테고리
CREATE TABLE CATEGORY(
    CATEGORY_NO NUMBER,         -- 카테고리 번호 PK
    CATEGORY_NAME NVARCHAR2(20), -- 카테고리 이름 
    CONSTRAINT CATEGORY_NO_PK PRIMARY KEY (CATEGORY_NO)
);
-- 제품
CREATE TABLE PRODUCT(
    PRODUCT_NO NUMBER,                  -- 제품번호 (PK)
    CATEGORY_NO NUMBER,                 -- 카테고리번호 (FK) 
    PRODUCT_NAME NVARCHAR2(50),         -- 제품이름
    PRODUCT_PRICE NUMBER,               -- 제품가격
    PRODUCT_IMAGE_PATH NVARCHAR2(255),  -- 제품 이미지사진 경로
    PRODUCT_ON_SALE NUMBER,             -- 제품 판매상태 (0 = X , 1 = O)
    PRODUCT_COST NUMBER,                -- 원가
    CONSTRAINT PRODUCT_NO_PK PRIMARY KEY (PRODUCT_NO),  
    CONSTRAINT CATEGORY_NO_FK FOREIGN KEY (CATEGORY_NO) REFERENCES CATEGORY(CATEGORY_NO)
    );

--폐기물 
CREATE TABLE WASTE(
    WASTE_NO NUMBER,    -- 폐기물번호 (PK)
    PRODUCT_NO NUMBER,  -- 제품번호 (FK)
    WASTE_DATE DATE,    -- 폐기일자
    CONSTRAINT WASTE_NO_PK PRIMARY KEY (WASTE_NO),
    CONSTRAINT WASTE_PRODUCT_NO_FK FOREIGN KEY (PRODUCT_NO) REFERENCES PRODUCT(PRODUCT_NO)
);

-- 모든 품목
CREATE TABLE ALL_PRODUCTS(
    SERIAL_NO NUMBER,       -- 시리얼번호 (PK)
    PRODUCT_NO NUMBER,      -- 제품번호 (FK)
    BUILD_DATE DATE,        -- 제조일
    EXPIRATION_DATE DATE,   -- 유통기한
    SUPPLIER NVARCHAR2(30), -- 공급처
    DELIVERY_DATE DATE,     -- 배송일자
    PRODUCT_STATE NUMBER,   -- 제품상태
    CONSTRAINT SERIAL_NO_PK PRIMARY KEY (SERIAL_NO),
    CONSTRAINT ALL_PRODUCTS_PRODUCT_NO_FK FOREIGN KEY (PRODUCT_NO) REFERENCES PRODUCT(PRODUCT_NO) 
);

-- 주문 (결제)
CREATE TABLE ORDER_(
    ORDER_NO NUMBER,        -- 주문번호(PK)
    ORDER_DATE DATE,        -- 주문일자
    PAYMENT_METHOD NUMBER,  -- 결제방식
    ORDER_AMOUNT NUMBER,    -- 총액
    CONSTRAINT ORDER_NO_PK PRIMARY KEY(ORDER_NO)
);

-- 주문상세 
CREATE TABLE ORDER_DETAIL(
    ORDER_DETAIL_NO NUMBER,     -- 주문상세번호(PK)
    ORDER_NO NUMBER,            -- 주문번호(FK)
    SERIAL_NO NUMBER,           -- 시리얼번호(FK)
    ORDER_DETAIL_PRICE NUMBER,  -- 상세가격
    PRODUCT_NO NUMBER, -- 제품번호
    CONSTRAINT ORDER_DETAIL_NO_PK PRIMARY KEY (ORDER_DETAIL_NO),
    CONSTRAINT ORDER_DETAIL_ORDER_NO_FK FOREIGN KEY (ORDER_NO) REFERENCES ORDER_(ORDER_NO) ON DELETE CASCADE,
    CONSTRAINT ORDER_DETAIL_SERIAL_NO_FK FOREIGN KEY (SERIAL_NO) REFERENCES ALL_PRODUCTS(SERIAL_NO)
);


-- 제품카테고리
INSERT INTO CATEGORY VALUES(1,'유제품');
INSERT INTO CATEGORY VALUES(2,'컵라면');
INSERT INTO CATEGORY VALUES(3,'라면');
INSERT INTO CATEGORY VALUES(4,'냉동식품');
INSERT INTO CATEGORY VALUES(5,'아이스크림');
-- 제품
INSERT INTO PRODUCT VALUES(1,1,'매일우유250ML',2500,NULL,1,1700);    
INSERT INTO PRODUCT VALUES(2,1,'서울우유250ML',2000,NULL,1,1600);
INSERT INTO PRODUCT VALUES(3,1,'맛있는우유500ML',5000,NULL,1,4000);
INSERT INTO PRODUCT VALUES(4,2,'왕뚜껑',1200,NULL,1,600);    
INSERT INTO PRODUCT VALUES(5,2,'불닭볶음면',1500,NULL,1,800);
INSERT INTO PRODUCT VALUES(6,3,'열라면',1000,NULL,1,800);
INSERT INTO PRODUCT VALUES(7,3,'신라면',1000,NULL,1,750);    
INSERT INTO PRODUCT VALUES(8,3,'진라면매운맛',1000,NULL,1,700);
INSERT INTO PRODUCT VALUES(9,4,'비비고왕교자',2400,NULL,1,1400);
INSERT INTO PRODUCT VALUES(10,4,'치킨너겟',2500,NULL,1,2000);    
INSERT INTO PRODUCT VALUES(11,5,'돼지바',400,NULL,1,300);
INSERT INTO PRODUCT VALUES(12,5,'스크류바',500,NULL,1,300);
--모든품목
INSERT INTO ALL_PRODUCTS VALUES(1,1,SYSDATE-10,SYSDATE+5,'임시공급처',SYSDATE,0);
INSERT INTO ALL_PRODUCTS VALUES(2,1,SYSDATE-7,SYSDATE+8,'임시공급처',SYSDATE-1,0);
INSERT INTO ALL_PRODUCTS VALUES(3,1,SYSDATE-6,SYSDATE+9,'임시공급처',SYSDATE-2,0);
INSERT INTO ALL_PRODUCTS VALUES(4,1,SYSDATE-2,SYSDATE+5,'임시공급처',SYSDATE,1);
INSERT INTO ALL_PRODUCTS VALUES(5,4,SYSDATE-10,SYSDATE+200,'임시공급처',SYSDATE,0);
INSERT INTO ALL_PRODUCTS VALUES(6,11,SYSDATE-1,NULL,'임시공급처',SYSDATE,0);
INSERT INTO ALL_PRODUCTS VALUES(7,12,SYSDATE-2,NULL,'임시공급처',SYSDATE,0);
INSERT INTO ALL_PRODUCTS VALUES(8,7,SYSDATE-30,SYSDATE+170,'임시공급처',SYSDATE,1);
INSERT INTO ALL_PRODUCTS VALUES(9,7,SYSDATE-30,SYSDATE+170,'임시공급처',SYSDATE,1);
INSERT INTO ALL_PRODUCTS VALUES(10,7,SYSDATE-30,SYSDATE+170,'임시공급처',SYSDATE,1);
INSERT INTO ALL_PRODUCTS VALUES(11,2,SYSDATE-30,SYSDATE+170,'임시공급처',SYSDATE,1);
INSERT INTO ALL_PRODUCTS VALUES(12,2,SYSDATE-30,SYSDATE+170,'임시공급처',SYSDATE,1);
--주문(결제) 1카드 2현금
INSERT INTO ORDER_ VALUES(1,SYSDATE-1,1,5000);
INSERT INTO ORDER_ VALUES(2,SYSDATE-1,1,900);
INSERT INTO ORDER_ VALUES(3,SYSDATE,2,3700);

-- 주문상세
INSERT INTO ORDER_DETAIL VALUES (1,1,1,2500,1);
INSERT INTO ORDER_DETAIL VALUES (2,1,2,2500,1);
INSERT INTO ORDER_DETAIL VALUES (3,2,6,400,1);
INSERT INTO ORDER_DETAIL VALUES (4,2,7,500,1);
INSERT INTO ORDER_DETAIL VALUES (5,3,3,2500,4);
INSERT INTO ORDER_DETAIL VALUES (6,3,5,1200,11);

-- 회원(근로자들)
INSERT INTO employee VALUES (1, 'SANAGO', '사나고', '2021/06/01', 8350, NULL);              
INSERT INTO employee VALUES (2, 'WACKGOOD', '우왁굳', '2021/06/01', 8350, NULL);
INSERT INTO employee VALUES (3, 'SWINGS', '스윙스', '2021/06/01', 8350, NULL);


-- DELETE FROM employee WHERE employee_NO < 8;
-- to_date('2021/06/01 00:00:00','yyyy-mm-dd hh24:mi:ss')

INSERT INTO office_hours VALUES (1, to_date('2021/06/01 00:00:00','yyyy-mm-dd hh24:mi:ss'),
                                    to_date('2021/06/01 08:00:00','yyyy-mm-dd hh24:mi:ss'), 8, 6);   
                                    
INSERT INTO office_hours VALUES (2, to_date('2021/06/01 08:00:00','yyyy-mm-dd hh24:mi:ss'),
                                    to_date('2021/06/01 16:00:00','yyyy-mm-dd hh24:mi:ss'), 8, 6);    
                                    
INSERT INTO office_hours VALUES (3, to_date('2021/06/01 16:00:00','yyyy-mm-dd hh24:mi:ss'),
                                    to_date('2021/06/01 23:59:59','yyyy-mm-dd hh24:mi:ss'), 8, 6);
                                    
COMMIT                                    